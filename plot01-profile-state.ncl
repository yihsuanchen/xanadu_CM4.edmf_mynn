load "$NCARG_ROOT/lib/ncarg/nclscripts/csm/gsn_code.ncl"
load "$NCARG_ROOT/lib/ncarg/nclscripts/wrf/WRFUserARW.ncl"
load "$NCARG_ROOT/lib/ncarg/nclscripts/csm/gsn_csm.ncl"
load "$NCARG_ROOT/lib/ncarg/nclscripts/csm/contributed.ncl"
load "$NCARG_ROOT/lib/ncarg/nclscripts/csm/shea_util.ncl"
load "/ncrc/home2/Yi-hsuan.Chen//script/ncl//ignorantNCL.ncl"
;load "./ignorantNCL.ncl"
load "/ncrc/home2/Yi-hsuan.Chen//script/ncl//ignorantNCL-colormaps.ncl"
;load "zz-read_parameters.ncl"

begin

  option = "AMIP_i8_j3_Arctic"

if (option .eq. "AMIP_i8_j3_Arctic") then
  ; pressure at half level (Pa)
  p_half  = (/     100.000  ,   400.000  ,   818.602  ,  1378.887  ,  2091.795  ,  2983.641  ,  4121.790  ,  5579.221  ,  7409.378  ,  9663.285  , 12406.054  , 15697.361  , 19597.140  , 24156.888  , 29420.986  , 35395.625  , 41981.101  , 48894.600  , 55728.527  , 62136.151  , 67939.543  , 73088.091  , 77590.103  , 81478.767  , 84804.113  , 87625.483  , 90003.609  , 91989.438  , 93633.370  , 94975.548  , 96048.177  , 96883.298  , 97491.239  , 97892.281  /)
  
  ; pressure at full level (Pa)
  p_full  = (/     216.404  ,   584.531  ,  1074.508  ,  1710.654  ,  2511.381  ,  3522.120  ,  4813.790  ,  6451.090  ,  8486.506  , 10977.622  , 13987.228  , 17575.199  , 21797.585  , 26702.513  , 32316.309  , 38594.768  , 45350.056  , 52237.081  , 58874.236  , 64994.671  , 70482.479  , 75316.673  , 79518.588  , 83130.355  , 86207.103  , 88809.239  , 90992.912  , 92808.977  , 94302.867  , 95510.859  , 96465.135  , 97186.951  , 97691.623  /)
  
  ; actual height at half level (m)
  z_half  = (/   41920.586  , 33835.916  , 29690.037  , 26703.222  , 24339.016  , 22307.916  , 20431.404  , 18642.567  , 16935.503  , 15306.906  , 13758.243  , 12286.856  , 10897.232  ,  9594.734  ,  8372.682  ,  7216.810  ,  6126.687  ,  5125.810  ,  4243.906  ,  3491.572  ,  2862.168  ,  2338.071  ,  1906.367  ,  1550.016  ,  1255.978  ,  1013.734  ,   814.869  ,   653.003  ,   521.960  ,   416.913  ,   334.190  ,   270.920  ,   225.437  ,   196.243  /)
  
  ; actual height at full level (m)
  z_full  = (/   37878.251  , 31762.976  , 28196.629  , 25521.119  , 23323.466  , 21369.660  , 19536.986  , 17789.035  , 16121.204  , 14532.575  , 13022.549  , 11592.044  , 10245.983  ,  8983.708  ,  7794.746  ,  6671.749  ,  5626.249  ,  4684.858  ,  3867.739  ,  3176.870  ,  2600.119  ,  2122.219  ,  1728.191  ,  1402.997  ,  1134.856  ,   914.301  ,   733.936  ,   587.481  ,   469.436  ,   375.552  ,   302.555  ,   248.178  ,   210.840  /)
  
  ; height at half level above the surface (m)
  z_half_surf0  = (/   41724.343  , 33639.672  , 29493.794  , 26506.978  , 24142.772  , 22111.673  , 20235.161  , 18446.323  , 16739.259  , 15110.663  , 13562.000  , 12090.612  , 10700.988  ,  9398.490  ,  8176.439  ,  7020.566  ,  5930.444  ,  4929.567  ,  4047.663  ,  3295.328  ,  2665.924  ,  2141.828  ,  1710.123  ,  1353.773  ,  1059.735  ,   817.491  ,   618.625  ,   456.759  ,   325.716  ,   220.670  ,   137.947  ,    74.676  ,    29.194  ,     0.000  /)
  
  ; height at full level above the surface (m)
  z_full_surf0  = (/   37682.008  , 31566.733  , 28000.386  , 25324.875  , 23127.222  , 21173.417  , 19340.742  , 17592.791  , 15924.961  , 14336.331  , 12826.306  , 11395.800  , 10049.739  ,  8787.465  ,  7598.503  ,  6475.505  ,  5430.005  ,  4488.615  ,  3671.495  ,  2980.626  ,  2403.876  ,  1925.975  ,  1531.948  ,  1206.754  ,   938.613  ,   718.058  ,   537.692  ,   391.238  ,   273.193  ,   179.308  ,   106.312  ,    51.935  ,    14.597  /)
  
  ; temperatur at full levels (K)
  tt  = (/     199.074  ,   197.630  ,   195.547  ,   193.674  ,   195.260  ,   198.252  ,   201.712  ,   205.426  ,   209.347  ,   211.611  ,   213.478  ,   213.806  ,   212.572  ,   211.631  ,   213.443  ,   218.109  ,   224.129  ,   230.118  ,   235.952  ,   240.605  ,   244.884  ,   246.497  ,   248.701  ,   250.868  ,   252.604  ,   253.445  ,   253.114  ,   252.480  ,   251.895  ,   251.401  ,   249.489  ,   248.272  ,   242.981  /)
  
  ; potential temperatur at full levels (K)
  th  = (/    1149.127  ,   858.832  ,   714.107  ,   619.271  ,   559.476  ,   515.722  ,   479.914  ,   449.533  ,   423.589  ,   397.813  ,   374.481  ,   351.369  ,   328.498  ,   308.619  ,   294.745  ,   286.291  ,   280.944  ,   277.030  ,   274.511  ,   272.125  ,   270.624  ,   267.292  ,   265.531  ,   264.467  ,   263.546  ,   262.187  ,   260.033  ,   257.921  ,   256.153  ,   254.722  ,   252.067  ,   250.304  ,   244.608  /)
  
  ; specific humidity at full levels (kg/kg)
  qq  = (/    0.1749E-05  ,  0.1745E-05  ,  0.1743E-05  ,  0.1746E-05  ,  0.1743E-05  ,  0.1726E-05  ,  0.1738E-05  ,  0.1798E-05  ,  0.1882E-05  ,  0.1984E-05  ,  0.2280E-05  ,  0.3111E-05  ,  0.5550E-05  ,  0.8931E-05  ,  0.1308E-04  ,  0.1763E-04  ,  0.3822E-04  ,  0.7639E-04  ,  0.1710E-03  ,  0.2273E-03  ,  0.3154E-03  ,  0.3990E-03  ,  0.4444E-03  ,  0.4858E-03  ,  0.5248E-03  ,  0.5340E-03  ,  0.5902E-03  ,  0.5868E-03  ,  0.5658E-03  ,  0.5448E-03  ,  0.4334E-03  ,  0.3208E-03  ,  0.2236E-03  /)
  
  ; cloud fraction (none)
  qa  = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.2335E-08  ,  0.7357E-08  ,  0.7351E-08  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.1674E-04  ,  0.3137E-02  ,  0.1779E-02  ,  0.5186E-01  ,  0.8006E-01  ,  0.5743E-01  ,  0.4010E-01  ,  0.7191E-01  ,  0.1848E-01  ,  0.1512E-01  ,  0.2295E+00  /)
  
  ; cloud liquid water mixing ratio at full levels (kg/kg)
  ql  = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.3787E-09  ,  0.1642E-08  ,  0.3720E-07  ,  0.4037E-07  ,  0.6350E-08  ,  0.2522E-08  ,  0.6865E-09  ,  0.3961E-09  ,  0.2304E-08  ,  0.3986E-09  /)
  
  ; cloud ice water mixing ratio at full levels (kg/kg)
  qi  = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.3071E-08  ,  0.1589E-08  ,  0.1315E-07  ,  0.2602E-07  ,  0.1679E-07  ,  0.7349E-08  ,  0.1101E-07  ,  0.3819E-08  ,  0.5754E-08  ,  0.1272E-07  /)
  
  ; total water mixing ratio (qv+ql+qi) at full levels (kg/kg)
  qt  = (/    0.1749E-05  ,  0.1745E-05  ,  0.1743E-05  ,  0.1746E-05  ,  0.1743E-05  ,  0.1726E-05  ,  0.1738E-05  ,  0.1798E-05  ,  0.1882E-05  ,  0.1984E-05  ,  0.2280E-05  ,  0.3111E-05  ,  0.5550E-05  ,  0.8931E-05  ,  0.1308E-04  ,  0.1763E-04  ,  0.3822E-04  ,  0.7639E-04  ,  0.1710E-03  ,  0.2273E-03  ,  0.3154E-03  ,  0.3990E-03  ,  0.4444E-03  ,  0.4859E-03  ,  0.5248E-03  ,  0.5341E-03  ,  0.5903E-03  ,  0.5868E-03  ,  0.5658E-03  ,  0.5448E-03  ,  0.4334E-03  ,  0.3208E-03  ,  0.2236E-03  /)
  
  ; turbulent kinetic energy (m2/s2)
  tke = (/    0.5000E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.7490E-04  ,  0.1609E-03  ,  0.4041E-03  ,  0.7079E-03  ,  0.9970E-03  ,  0.1211E-02  ,  0.5035E-02  ,  0.5306E-01  ,  0.4253E+00  ,  0.4764E+00  /)
  
  ; EDMF diffusion coefficients for heat (K m/s)
  diff_t_edmf = (/    0.0000E+00  ,  0.5419E-06  ,  0.3605E-05  ,  0.1187E-05  ,  0.7750E-07  ,  0.2319E-04  ,  0.3461E-04  ,  0.9636E-04  ,  0.1670E-03  ,  0.1855E-03  ,  0.1465E-03  ,  0.1040E-03  ,  0.8058E-04  ,  0.8710E-04  ,  0.8371E-04  ,  0.1428E-04  ,  0.3248E-04  ,  0.1687E-04  ,  0.4973E-05  ,  0.3372E-05  ,  0.3939E-03  ,  0.4020E-04  ,  0.3443E-03  ,  0.1118E-02  ,  0.1686E-02  ,  0.1422E-02  ,  0.8312E-03  ,  0.1160E-02  ,  0.1305E-02  ,  0.1291E-02  ,  0.1637E-02  ,  0.3465E-02  ,  0.4652E-01  /)
  
  ; EDMF diffusion coefficients for momentum (m2/s)
  diff_m_edmf = (/    0.0000E+00  ,  0.5290E-02  ,  0.5717E-02  ,  0.6121E-02  ,  0.6988E-02  ,  0.7670E-02  ,  0.8197E-02  ,  0.8607E-02  ,  0.9004E-02  ,  0.8784E-02  ,  0.9065E-02  ,  0.8921E-02  ,  0.8729E-02  ,  0.9062E-02  ,  0.1055E-01  ,  0.1326E-01  ,  0.1607E-01  ,  0.1785E-01  ,  0.2079E-01  ,  0.1963E-01  ,  0.2211E-01  ,  0.1377E-01  ,  0.1678E-01  ,  0.1851E-01  ,  0.1724E-01  ,  0.1536E-01  ,  0.1555E-01  ,  0.2703E-01  ,  0.2474E-01  ,  0.2550E-01  ,  0.9097E-01  ,  0.9435E-01  ,  0.2892E+01  /)
  
  ; u tendency from edmf_mynn (m/s2)
  udt_edmf = (/    0.0000E+00  ,  0.2075E-08  , -0.5467E-10  , -0.7038E-09  , -0.7010E-08  , -0.3268E-08  , -0.7824E-08  , -0.6798E-08  , -0.6414E-08  , -0.2122E-08  , -0.1157E-08  , -0.1527E-08  , -0.3403E-08  , -0.1982E-08  ,  0.8490E-08  ,  0.6751E-08  , -0.4304E-08  , -0.3733E-09  ,  0.3794E-08  , -0.2681E-07  ,  0.4991E-07  , -0.1547E-08  , -0.1547E-06  , -0.3323E-07  ,  0.1249E-07  ,  0.1190E-06  ,  0.1669E-06  ,  0.7379E-06  ,  0.8593E-05  ,  0.9349E-04  ,  0.4659E-04  , -0.1971E-03  , -0.4489E-03  /)
  
  ; v tendency from edmf_mynn (m/s2)
  vdt_edmf = (/    0.0000E+00  , -0.7209E-09  ,  0.9506E-10  ,  0.4858E-10  , -0.7456E-09  ,  0.1558E-08  , -0.1195E-08  ,  0.6579E-08  , -0.2008E-08  , -0.1141E-08  , -0.3528E-10  ,  0.1563E-08  ,  0.1964E-08  , -0.4206E-08  , -0.1597E-09  ,  0.1006E-07  , -0.2937E-08  , -0.6214E-08  , -0.3670E-08  ,  0.4176E-07  , -0.5419E-07  , -0.5530E-07  ,  0.1356E-07  ,  0.2046E-06  ,  0.1074E-06  ,  0.1922E-06  ,  0.7754E-06  ,  0.6538E-05  ,  0.2435E-04  ,  0.6902E-04  , -0.7793E-04  , -0.6678E-03  , -0.7813E-03  /)
  
  ; t tendency from edmf_mynn (K/s)
  tdt_edmf = (/    0.0000E+00  , -0.1063E-10  ,  0.5286E-11  ,  0.4172E-11  , -0.1059E-09  , -0.7059E-10  , -0.3171E-09  , -0.4022E-09  , -0.3413E-09  ,  0.4115E-10  ,  0.5154E-10  , -0.1251E-10  , -0.1473E-09  ,  0.9478E-10  ,  0.4879E-09  , -0.5473E-10  ,  0.6483E-10  ,  0.4731E-10  ,  0.2877E-11  , -0.1472E-08  ,  0.1218E-08  , -0.2782E-08  , -0.5836E-08  , -0.7347E-08  , -0.1261E-07  , -0.6951E-08  ,  0.3396E-04  ,  0.1242E-02  ,  0.9403E-02  ,  0.4613E-01  ,  0.5857E-01  ,  0.8811E-01  ,  0.3425E-01  /)
  
  ; q tendency from edmf_mynn (kg/kg/s)
  qdt_edmf = (/    0.0000E+00  , -0.7035E-21  ,  0.1201E-20  , -0.5506E-21  , -0.1212E-18  ,  0.2380E-18  ,  0.2051E-17  ,  0.3894E-17  ,  0.3748E-17  ,  0.1417E-16  ,  0.2880E-16  ,  0.7900E-16  ,  0.9875E-16  ,  0.8967E-16  , -0.1771E-15  ,  0.5798E-15  ,  0.1259E-15  , -0.4848E-16  , -0.3507E-15  ,  0.9831E-13  , -0.9747E-13  ,  0.7811E-13  ,  0.2981E-12  ,  0.3687E-12  , -0.7454E-12  ,  0.1073E-11  , -0.1211E-07  , -0.4397E-06  , -0.3321E-05  , -0.1632E-04  , -0.2046E-04  , -0.3089E-04  , -0.1306E-04  /)
  
  ; qt tendency from edmf_mynn (kg/kg/s)
  qtdt_edmf = (/    0.0000E+00  , -0.7035E-21  ,  0.1201E-20  , -0.5506E-21  , -0.1212E-18  ,  0.2380E-18  ,  0.2051E-17  ,  0.3894E-17  ,  0.3748E-17  ,  0.1417E-16  ,  0.2880E-16  ,  0.7900E-16  ,  0.9875E-16  ,  0.8967E-16  , -0.1771E-15  ,  0.5798E-15  ,  0.1259E-15  , -0.4848E-16  , -0.3507E-15  ,  0.9831E-13  , -0.9747E-13  ,  0.7811E-13  ,  0.2981E-12  ,  0.3687E-12  , -0.7454E-12  ,  0.1073E-11  ,  0.1217E-08  ,  0.3966E-07  ,  0.3115E-06  ,  0.1577E-05  ,  0.1983E-05  ,  0.2413E-05  , -0.1306E-04  /)
  
  ; thl tendency from edmf_mynn (K/s)
  thldt_edmf = (/    0.0000E+00  , -0.4618E-10  ,  0.1930E-10  ,  0.1334E-10  , -0.3036E-09  , -0.1836E-09  , -0.7544E-09  , -0.8802E-09  , -0.6905E-09  ,  0.7736E-10  ,  0.9040E-10  , -0.2056E-10  , -0.2276E-09  ,  0.1382E-09  ,  0.6737E-09  , -0.7184E-10  ,  0.8127E-10  ,  0.5695E-10  ,  0.3347E-11  , -0.1665E-08  ,  0.1346E-08  , -0.3016E-08  , -0.6231E-08  , -0.7746E-08  , -0.1315E-07  , -0.7190E-08  , -0.3707E-05  , -0.1129E-03  , -0.8577E-03  , -0.4423E-02  , -0.4789E-02  , -0.5871E-02  ,  0.3448E-01  /)


else
 ; remove the space at the beginning    : [1,$s/^ */  /g]
 ; replace ",$" to "/)" at the end      : [1,$s/,$/\/)/g]
  
  print("ERROR: non support option "+option)
  exit

end if

exit


  ZW = ZW(::-1)
    ZW@long_name = "Height"
    ZW@units     = "m"
  z_full = z_full
    z_full@long_name = "Height"
    z_full@units     = "m"
  UPA = UPA(::-1)
    UPA@long_name = "updraft fraction"
    UPA@units     = "none"
  UPW = UPW(::-1)
    UPW@long_name = "updraft velocity"
    UPW@units     = "m/s"
  ENT = ENT(::-1)*1000.
    ENT@long_name = "entainment rate"
    ENT@units     = "1/km"
  DET = DET(::-1)*1000.
    DET@long_name = "dentainment rate"
    DET@units     = "1/km"

  ENTmDET = diff(ENT,DET)
    ENTmDET@long_name = "entainment minus detrainment"
    ENTmDET@units     = ENT@units

  MF=UPA*UPW*UPRHO(::-1)
    MF@long_name = "mass flux"
    MF@units     = "kg/m2/s"

  print("ZW: "+ZW+", MF: "+MF)
  print("---------------")
  print("ENT: "+ENT+", DET: "+DET)

;------------------
; general settings
;------------------

  wks_name = "test111" + "-" + option
  wks_type = "png"  ; or x11,pdf,ncgm
  wks = gsn_open_wks(wks_type, wks_name)
  res = True
    res@xyMonoMarkLineMode = True
    res@xyMarkLineMode  = "MarkLines"

  res_xy1 = res

    res_xy1@gsnFrame = False
    res_xy1@gsnDraw = False
    res_xy1@gsnXRefLine = 0.

    res_xy1@trYMinF = 0.
    res_xy1@trYMaxF = 1200.

    ;res_xy1@tiMainString = tiMainString
  opt_xy1 = True
    opt_xy1@gsnString = "x"
    opt_xy1@legend_mean = False

  ks = 24
  ke = 33

  xx1 = UPW(ks:)
  yy1 = ZW(ks:)
  labels1 = UPW@long_name
  plot_xy01 = ignorant_xy(wks, xx1, yy1, labels1, res_xy1, opt_xy1)

  xx2 = UPA(ks:)
  yy2 = ZW(ks:)
  labels2 = UPA@long_name
  plot_xy02 = ignorant_xy(wks, xx2, yy2, labels2, res_xy1, opt_xy1)

  xx3 = (/ENT(ks:),DET(ks:),ENTmDET(ks:)/)
    xx3@units = ENT@units
  yy3 = z_full(ks:)
  labels3 = (/"ent","det","ent-det"/)
  plot_xy03 = ignorant_xy(wks, xx3, yy3, labels3, res_xy1, opt_xy1)

  xx4 = MF(ks:)
  yy4 = ZW(ks:)
  labels4 = UPA@long_name
  plot_xy04 = ignorant_xy(wks, xx4, yy4, labels4, res_xy1, opt_xy1)

;--------
; plot
;--------
  resp = True
    resp@txString = option

  nn=4
  plot = new(nn,"graphic")
  plot(0) = plot_xy01
  plot(1) = plot_xy02
  plot(2) = plot_xy04
  plot(3) = plot_xy03

  gsn_panel(wks,plot,(/1,nn/),resp)
  opt1 = True
  trim_fig(wks_type, wks_name, opt1)

  exit

;==================
  ks = 28
  ke = kx-1
  yy = z_full(ks:ke)
  xx = th(:,ks:ke)
  labels_xy1 = new ( tx, "string" )

  ss1 = "dry SCM, Hour "
  do tt=0,tx-1
    labels_xy1(tt) = ss1+tt
  end do


;--------
; plot
;--------
  plot_xy1 = ignorant_xy(wks, xx, yy, labels_xy1, res_xy1, opt_xy1)
  opt1 = True
  trim_fig(wks_type, wks_name, opt1)


end
