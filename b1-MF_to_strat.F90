program test111
  implicit none
  integer, parameter :: kts=1
  integer, parameter :: kte=33

  real, dimension(kts:kte) :: &
    zfull, tb, pmid, qv,qc,ql,qi,cldfra_bl1d, &
    qadt_uws, qasub_uws, qadet_uws, qldt_uws, qlsub_uws, qldet_uws, qidt_uws, qisub_uws, qidet_uws, &
    qadt_uwd, qasub_uwd, qadet_uwd, qldt_uwd, qlsub_uwd, qldet_uwd, qidt_uwd, qisub_uwd, qidet_uwd, &
    Qql_adv,Qqi_adv,Qa_adv, Qql_eddy,Qqi_eddy,Qa_eddy, &
    Qql_ent,Qqi_ent,Qa_ent, Qql_det,Qqi_det,Qa_det, Qql_sub,Qqi_sub,Qa_sub

  real, dimension(kts:kte+1) :: &
    zw, cmf, cmf_uws, cmf_uwd

  integer :: choice_profile
  character*1 :: conv

  logical :: do_print

  integer i,j,k
  real dum1, dum2

!-------------------
  !choice_profile=1 ; if (choice_profile.eq.1) conv = "s"
  !choice_profile=2 ; if (choice_profile.eq.2) conv = "d"
  !choice_profile=2 ; if (choice_profile.eq.2) conv = "s"
  choice_profile=3 ; if (choice_profile.eq.3) conv = "s"
  !choice_profile=3 ; if (choice_profile.eq.3) conv = "d"


  if (choice_profile.eq.1) then
  !======== input argument ============
  ! height@model interfaces(m)
  zw = (/    0.4433E+05  ,  0.3621E+05  ,  0.3202E+05  ,  0.2896E+05  ,  0.2652E+05  ,  0.2444E+05  ,  0.2255E+05  ,  0.2078E+05  ,  0.1910E+05  ,  0.1748E+05  ,  0.1588E+05  ,  0.1430E+05  ,  0.1275E+05  ,  0.1125E+05  ,  0.9786E+04  ,  0.8378E+04  ,  0.7048E+04  ,  0.5835E+04  ,  0.4775E+04  ,  0.3882E+04  ,  0.3140E+04  ,  0.2527E+04  ,  0.2019E+04  ,  0.1601E+04  ,  0.1257E+04  ,  0.9734E+03  ,  0.7402E+03  ,  0.5492E+03  ,  0.3936E+03  ,  0.2682E+03  ,  0.1688E+03  ,  0.9203E+02  ,  0.3647E+02  ,  0.0000E+00  /)
  
  ! height@model mid-levels (m)
  zfull = (/    0.4027E+05  ,  0.3412E+05  ,  0.3049E+05  ,  0.2774E+05  ,  0.2548E+05  ,  0.2350E+05  ,  0.2166E+05  ,  0.1994E+05  ,  0.1829E+05  ,  0.1668E+05  ,  0.1509E+05  ,  0.1353E+05  ,  0.1200E+05  ,  0.1052E+05  ,  0.9082E+04  ,  0.7713E+04  ,  0.6441E+04  ,  0.5305E+04  ,  0.4329E+04  ,  0.3511E+04  ,  0.2833E+04  ,  0.2273E+04  ,  0.1810E+04  ,  0.1429E+04  ,  0.1115E+04  ,  0.8568E+03  ,  0.6447E+03  ,  0.4714E+03  ,  0.3309E+03  ,  0.2185E+03  ,  0.1304E+03  ,  0.6425E+02  ,  0.1824E+02  /)
  
  ! temperature profile (K)
  tb = (/    0.2000E+03  ,  0.2000E+03  ,  0.2000E+03  ,  0.2000E+03  ,  0.2000E+03  ,  0.2000E+03  ,  0.2000E+03  ,  0.2000E+03  ,  0.2045E+03  ,  0.2148E+03  ,  0.2244E+03  ,  0.2335E+03  ,  0.2420E+03  ,  0.2498E+03  ,  0.2571E+03  ,  0.2636E+03  ,  0.2694E+03  ,  0.2742E+03  ,  0.2782E+03  ,  0.2814E+03  ,  0.2844E+03  ,  0.2879E+03  ,  0.2885E+03  ,  0.2904E+03  ,  0.2920E+03  ,  0.2936E+03  ,  0.2948E+03  ,  0.2957E+03  ,  0.2967E+03  ,  0.2978E+03  ,  0.2986E+03  ,  0.2993E+03  ,  0.2998E+03  /)
  
  ! specific humidity profile (kg/kg)
  qv = (/    0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.2490E-03  ,  0.1417E-02  ,  0.2395E-02  ,  0.3206E-02  ,  0.3944E-02  ,  0.8530E-02  ,  0.1056E-01  ,  0.1212E-01  ,  0.1336E-01  ,  0.1465E-01  ,  0.1593E-01  ,  0.1650E-01  ,  0.1671E-01  ,  0.1687E-01  ,  0.1703E-01  ,  0.1729E-01  /)
  
  ! pressure@model mid-levels (pa)
  pmid = (/    0.2164E+03  ,  0.5845E+03  ,  0.1075E+04  ,  0.1711E+04  ,  0.2511E+04  ,  0.3522E+04  ,  0.4814E+04  ,  0.6460E+04  ,  0.8529E+04  ,  0.1109E+05  ,  0.1420E+05  ,  0.1791E+05  ,  0.2230E+05  ,  0.2739E+05  ,  0.3323E+05  ,  0.3977E+05  ,  0.4680E+05  ,  0.5397E+05  ,  0.6087E+05  ,  0.6725E+05  ,  0.7296E+05  ,  0.7800E+05  ,  0.8237E+05  ,  0.8613E+05  ,  0.8934E+05  ,  0.9204E+05  ,  0.9432E+05  ,  0.9621E+05  ,  0.9777E+05  ,  0.9902E+05  ,  0.1000E+06  ,  0.1008E+06  ,  0.1013E+06  /)
  
  ! input liq_wat
  ql = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.6765E-05  ,  0.1641E-05  ,  0.9163E-06  ,  0.9407E-06  ,  0.3791E-06  ,  0.1202E-07  ,  0.1595E-08  ,  0.8055E-09  ,  0.5913E-09  ,  0.5025E-09  ,  0.4539E-09  /)
  
  ! input ice_wat
  qi = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! input cld_amt
  cldfra_bl1d = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.3050E-01  ,  0.2297E-01  ,  0.2408E-01  ,  0.2921E-01  ,  0.2488E-01  ,  0.1072E-02  ,  0.1422E-03  ,  0.7179E-04  ,  0.5270E-04  ,  0.4478E-04  ,  0.4045E-04  /)
  
  !------ cmf -----
  ! cmf_uws 
  cmf_uws = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.1453E-01  ,  0.1668E-01  ,  0.1933E-01  ,  0.2773E-01  ,  0.4546E-01  ,  0.3279E-01  ,  0.2245E-01  ,  0.1419E-01  ,  0.7757E-02  ,  0.3081E-02  ,  0.0000E+00  /)
  
  ! cmf_uwd 
  cmf_uwd = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  !======== output argument from uw_conv ============
  
  !------ qa -----
  ! qadt_uws 
  qadt_uws = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.1758E-06  ,  0.1098E-04  ,  0.7464E-05  ,  0.8511E-05  ,  0.1816E-04  ,  0.4267E-04  ,  0.5736E-04  ,  0.1618E-06  ,  0.1005E-07  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! qadet_uws
  qadet_uws = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.1153E-04  ,  0.7158E-05  ,  0.8572E-05  ,  0.1859E-04  ,  0.4199E-04  ,  0.5253E-04  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! qasub_uws
  qasub_uws = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.1758E-06  , -0.5436E-06  ,  0.3060E-06  , -0.6089E-07  , -0.4367E-06  ,  0.6821E-06  ,  0.4830E-05  ,  0.1618E-06  ,  0.1005E-07  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! qadt_uwd
  qadt_uwd = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! qadet_uwd
  qadet_uwd = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! qasub_uwd
  qasub_uwd = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  !------ ql -----
  ! qldt_uws 
  qldt_uws = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.3900E-10  ,  0.6313E-08  ,  0.8056E-08  ,  0.8381E-08  ,  0.1319E-07  ,  0.1384E-07  ,  0.3343E-08  ,  0.1816E-11  ,  0.1127E-12  ,  0.2320E-13  ,  0.6286E-14  ,  0.0000E+00  /)
  
  ! qldet_uws
  qldet_uws = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.6457E-08  ,  0.7848E-08  ,  0.8341E-08  ,  0.1319E-07  ,  0.1375E-07  ,  0.3269E-08  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! qlsub_uws
  qlsub_uws = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.3900E-10  , -0.1442E-09  ,  0.2083E-09  ,  0.3989E-10  , -0.2072E-11  ,  0.8848E-10  ,  0.7447E-10  ,  0.1816E-11  ,  0.1127E-12  ,  0.2320E-13  ,  0.6286E-14  ,  0.0000E+00  /)
  
  ! qldt_uwd
  qldt_uwd = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! qldet_uwd
  qldet_uwd = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! qlsub_uwd
  qlsub_uwd = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  !------ qi -----
  ! qidt_uws 
  qidt_uws = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! qidet_uws
  qidet_uws = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! qisub_uws
  qisub_uws = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! qidt_uwd
  qidt_uwd = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! qidet_uwd
  qidet_uwd = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! qisub_uwd
  qisub_uwd = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)

  !@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  elseif (choice_profile.eq.2) then
  ! height@model interfaces(m)
  zw = (/    0.4433E+05  ,  0.3621E+05  ,  0.3202E+05  ,  0.2896E+05  ,  0.2652E+05  ,  0.2444E+05  ,  0.2255E+05  ,  0.2078E+05  ,  0.1910E+05  ,  0.1748E+05  ,  0.1588E+05  ,  0.1430E+05  ,  0.1275E+05  ,  0.1125E+05  ,  0.9787E+04  ,  0.8379E+04  ,  0.7048E+04  ,  0.5835E+04  ,  0.4776E+04  ,  0.3882E+04  ,  0.3140E+04  ,  0.2527E+04  ,  0.2019E+04  ,  0.1602E+04  ,  0.1257E+04  ,  0.9739E+03  ,  0.7406E+03  ,  0.5495E+03  ,  0.3939E+03  ,  0.2683E+03  ,  0.1689E+03  ,  0.9208E+02  ,  0.3649E+02  ,  0.0000E+00  /)
  
  ! height@model mid-levels (m)
  zfull = (/    0.4027E+05  ,  0.3412E+05  ,  0.3049E+05  ,  0.2774E+05  ,  0.2548E+05  ,  0.2350E+05  ,  0.2166E+05  ,  0.1994E+05  ,  0.1829E+05  ,  0.1668E+05  ,  0.1509E+05  ,  0.1353E+05  ,  0.1200E+05  ,  0.1052E+05  ,  0.9083E+04  ,  0.7713E+04  ,  0.6441E+04  ,  0.5305E+04  ,  0.4329E+04  ,  0.3511E+04  ,  0.2833E+04  ,  0.2273E+04  ,  0.1810E+04  ,  0.1430E+04  ,  0.1116E+04  ,  0.8572E+03  ,  0.6451E+03  ,  0.4717E+03  ,  0.3311E+03  ,  0.2186E+03  ,  0.1305E+03  ,  0.6428E+02  ,  0.1825E+02  /)
  
  ! temperature profile (K)
  tb = (/    0.2000E+03  ,  0.2000E+03  ,  0.2000E+03  ,  0.2000E+03  ,  0.2000E+03  ,  0.2000E+03  ,  0.2000E+03  ,  0.2000E+03  ,  0.2045E+03  ,  0.2148E+03  ,  0.2244E+03  ,  0.2335E+03  ,  0.2420E+03  ,  0.2498E+03  ,  0.2571E+03  ,  0.2636E+03  ,  0.2694E+03  ,  0.2742E+03  ,  0.2782E+03  ,  0.2814E+03  ,  0.2844E+03  ,  0.2877E+03  ,  0.2883E+03  ,  0.2906E+03  ,  0.2922E+03  ,  0.2937E+03  ,  0.2949E+03  ,  0.2958E+03  ,  0.2968E+03  ,  0.2979E+03  ,  0.2988E+03  ,  0.2994E+03  ,  0.2999E+03  /)
  
  ! specific humidity profile (kg/kg)
  qv = (/    0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.2490E-03  ,  0.1417E-02  ,  0.2395E-02  ,  0.3206E-02  ,  0.4171E-02  ,  0.9052E-02  ,  0.1035E-01  ,  0.1176E-01  ,  0.1315E-01  ,  0.1443E-01  ,  0.1595E-01  ,  0.1671E-01  ,  0.1702E-01  ,  0.1718E-01  ,  0.1732E-01  ,  0.1753E-01  /)
  
  ! pressure@model mid-levels (pa)
  pmid = (/    0.2164E+03  ,  0.5845E+03  ,  0.1075E+04  ,  0.1711E+04  ,  0.2511E+04  ,  0.3522E+04  ,  0.4814E+04  ,  0.6460E+04  ,  0.8529E+04  ,  0.1109E+05  ,  0.1420E+05  ,  0.1791E+05  ,  0.2230E+05  ,  0.2739E+05  ,  0.3323E+05  ,  0.3977E+05  ,  0.4680E+05  ,  0.5397E+05  ,  0.6087E+05  ,  0.6725E+05  ,  0.7296E+05  ,  0.7800E+05  ,  0.8237E+05  ,  0.8613E+05  ,  0.8934E+05  ,  0.9204E+05  ,  0.9432E+05  ,  0.9621E+05  ,  0.9777E+05  ,  0.9902E+05  ,  0.1000E+06  ,  0.1008E+06  ,  0.1013E+06  /)
  
  ! input liq_wat
  ql = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.5933E-07  ,  0.7912E-05  ,  0.6735E-06  ,  0.1692E-06  ,  0.2506E-06  ,  0.1511E-06  ,  0.1262E-08  ,  0.1838E-09  ,  0.7737E-10  ,  0.5627E-10  ,  0.4832E-10  ,  0.4445E-10  /)
  
  ! input ice_wat
  qi = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! input cld_amt
  cldfra_bl1d = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.6749E-03  ,  0.7719E-01  ,  0.2149E-01  ,  0.1713E-01  ,  0.2394E-01  ,  0.3006E-01  ,  0.7368E-03  ,  0.1073E-03  ,  0.4518E-04  ,  0.3286E-04  ,  0.2822E-04  ,  0.2596E-04  /)
  
  !------ cmf -----
  ! cmf_uws 
  cmf_uws = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.3586E-04  ,  0.4170E-04  ,  0.4869E-04  ,  0.6549E-04  ,  0.1043E-03  ,  0.7523E-04  ,  0.5150E-04  ,  0.3255E-04  ,  0.1780E-04  ,  0.7068E-05  ,  0.0000E+00  /)
  
  ! cmf_uwd 
  cmf_uwd = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.5036E-02  ,  0.4973E-02  ,  0.5126E-02  ,  0.5588E-02  ,  0.6412E-02  ,  0.4625E-02  ,  0.3166E-02  ,  0.2001E-02  ,  0.1094E-02  ,  0.4346E-03  ,  0.0000E+00  /)
  
  !======== output argument from uw_conv ============
  
  !------ qa -----
  ! qadt_uws 
  qadt_uws = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.1633E-08  ,  0.2624E-07  ,  0.2382E-07  ,  0.2261E-07  ,  0.3765E-07  ,  0.8946E-07  ,  0.1342E-06  , -0.1546E-07  , -0.1251E-08  , -0.1882E-09  , -0.4633E-10  ,  0.0000E+00  /)
  
  ! qadet_uws
  qadet_uws = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.3070E-07  ,  0.1820E-07  ,  0.2201E-07  ,  0.3906E-07  ,  0.9170E-07  ,  0.1205E-06  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! qasub_uws
  qasub_uws = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.1633E-08  , -0.4457E-08  ,  0.5626E-08  ,  0.6030E-09  , -0.1406E-08  , -0.2236E-08  ,  0.1364E-07  , -0.1546E-07  , -0.1251E-08  , -0.1882E-09  , -0.4633E-10  ,  0.0000E+00  /)
  
  ! qadt_uwd
  qadt_uwd = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.9051E-08  ,  0.1612E-05  ,  0.5562E-05  ,  0.1213E-05  ,  0.7198E-06  ,  0.9425E-06  ,  0.1758E-05  ,  0.3029E-05  ,  0.1546E-07  ,  0.1251E-08  ,  0.1882E-09  ,  0.4633E-10  ,  0.0000E+00  /)
  
  ! qadet_uwd
  qadet_uwd = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.6469E-05  ,  0.4864E-06  ,  0.6524E-06  ,  0.1074E-05  ,  0.1916E-05  ,  0.2190E-05  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! qasub_uwd
  qasub_uwd = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.9051E-08  ,  0.1612E-05  , -0.9063E-06  ,  0.7264E-06  ,  0.6739E-07  , -0.1320E-06  , -0.1581E-06  ,  0.8389E-06  ,  0.1546E-07  ,  0.1251E-08  ,  0.1882E-09  ,  0.4633E-10  ,  0.0000E+00  /)
  
  !------ ql -----
  ! qldt_uws 
  qldt_uws = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.1676E-12  ,  0.1732E-10  ,  0.2043E-10  ,  0.2118E-10  ,  0.2811E-10  ,  0.3329E-10  ,  0.9702E-11  ,  0.4305E-15  ,  0.3486E-16  ,  0.5243E-17  ,  0.1291E-17  ,  0.0000E+00  /)
  
  ! qldet_uws
  qldet_uws = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.1781E-10  ,  0.1970E-10  ,  0.2111E-10  ,  0.2812E-10  ,  0.3326E-10  ,  0.9632E-11  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! qlsub_uws
  qlsub_uws = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.1676E-12  , -0.4959E-12  ,  0.7311E-12  ,  0.6969E-13  , -0.1681E-13  ,  0.3638E-13  ,  0.6973E-13  ,  0.4305E-15  ,  0.3486E-16  ,  0.5243E-17  ,  0.1291E-17  ,  0.0000E+00  /)
  
  ! qldt_uwd
  qldt_uwd = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.7956E-12  ,  0.1655E-09  ,  0.4876E-08  ,  0.7611E-09  ,  0.7238E-09  ,  0.8081E-09  ,  0.7013E-09  ,  0.1793E-09  ,  0.2647E-13  ,  0.2143E-14  ,  0.3223E-15  ,  0.7935E-16  ,  0.0000E+00  /)
  
  ! qldet_uwd
  qldet_uwd = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.4982E-08  ,  0.6667E-09  ,  0.7160E-09  ,  0.8097E-09  ,  0.6987E-09  ,  0.1750E-09  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! qlsub_uwd
  qlsub_uwd = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.7956E-12  ,  0.1655E-09  , -0.1061E-09  ,  0.9440E-10  ,  0.7789E-11  , -0.1578E-11  ,  0.2573E-11  ,  0.4287E-11  ,  0.2647E-13  ,  0.2143E-14  ,  0.3223E-15  ,  0.7935E-16  ,  0.0000E+00  /)
  
  !------ qi -----
  ! qidt_uws 
  qidt_uws = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! qidet_uws
  qidet_uws = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! qisub_uws
  qisub_uws = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! qidt_uwd
  qidt_uwd = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! qidet_uwd
  qidet_uwd = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! qisub_uwd
  qisub_uwd = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)

  !@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  elseif (choice_profile.eq.3) then

  !======== input argument ============
  ! height@model interfaces(m)
  zw = (/    0.4433E+05  ,  0.3621E+05  ,  0.3202E+05  ,  0.2896E+05  ,  0.2652E+05  ,  0.2444E+05  ,  0.2255E+05  ,  0.2078E+05  ,  0.1910E+05  ,  0.1748E+05  ,  0.1588E+05  ,  0.1430E+05  ,  0.1275E+05  ,  0.1125E+05  ,  0.9787E+04  ,  0.8379E+04  ,  0.7048E+04  ,  0.5835E+04  ,  0.4776E+04  ,  0.3882E+04  ,  0.3140E+04  ,  0.2527E+04  ,  0.2019E+04  ,  0.1602E+04  ,  0.1258E+04  ,  0.9740E+03  ,  0.7407E+03  ,  0.5496E+03  ,  0.3939E+03  ,  0.2684E+03  ,  0.1689E+03  ,  0.9209E+02  ,  0.3650E+02  ,  0.0000E+00  /)
  
  ! height@model mid-levels (m)
  zfull = (/    0.4027E+05  ,  0.3412E+05  ,  0.3049E+05  ,  0.2774E+05  ,  0.2548E+05  ,  0.2350E+05  ,  0.2166E+05  ,  0.1994E+05  ,  0.1829E+05  ,  0.1668E+05  ,  0.1509E+05  ,  0.1353E+05  ,  0.1200E+05  ,  0.1052E+05  ,  0.9083E+04  ,  0.7713E+04  ,  0.6441E+04  ,  0.5305E+04  ,  0.4329E+04  ,  0.3511E+04  ,  0.2834E+04  ,  0.2273E+04  ,  0.1811E+04  ,  0.1430E+04  ,  0.1116E+04  ,  0.8574E+03  ,  0.6452E+03  ,  0.4718E+03  ,  0.3311E+03  ,  0.2186E+03  ,  0.1305E+03  ,  0.6430E+02  ,  0.1825E+02  /)
  
  ! temperature profile (K)
  tb = (/    0.2000E+03  ,  0.2000E+03  ,  0.2000E+03  ,  0.2000E+03  ,  0.2000E+03  ,  0.2000E+03  ,  0.2000E+03  ,  0.2000E+03  ,  0.2045E+03  ,  0.2148E+03  ,  0.2244E+03  ,  0.2335E+03  ,  0.2420E+03  ,  0.2498E+03  ,  0.2571E+03  ,  0.2636E+03  ,  0.2694E+03  ,  0.2742E+03  ,  0.2782E+03  ,  0.2814E+03  ,  0.2844E+03  ,  0.2875E+03  ,  0.2884E+03  ,  0.2906E+03  ,  0.2923E+03  ,  0.2938E+03  ,  0.2950E+03  ,  0.2959E+03  ,  0.2969E+03  ,  0.2979E+03  ,  0.2988E+03  ,  0.2994E+03  ,  0.2999E+03  /)
  
  ! specific humidity profile (kg/kg)
  qv = (/    0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.5000E-15  ,  0.2490E-03  ,  0.1417E-02  ,  0.2395E-02  ,  0.3229E-02  ,  0.4371E-02  ,  0.9181E-02  ,  0.1031E-01  ,  0.1161E-01  ,  0.1299E-01  ,  0.1429E-01  ,  0.1590E-01  ,  0.1685E-01  ,  0.1715E-01  ,  0.1731E-01  ,  0.1745E-01  ,  0.1765E-01  /)
  
  ! pressure@model mid-levels (pa)
  pmid = (/    0.2164E+03  ,  0.5845E+03  ,  0.1075E+04  ,  0.1711E+04  ,  0.2511E+04  ,  0.3522E+04  ,  0.4814E+04  ,  0.6460E+04  ,  0.8529E+04  ,  0.1109E+05  ,  0.1420E+05  ,  0.1791E+05  ,  0.2230E+05  ,  0.2739E+05  ,  0.3323E+05  ,  0.3977E+05  ,  0.4680E+05  ,  0.5397E+05  ,  0.6087E+05  ,  0.6725E+05  ,  0.7296E+05  ,  0.7800E+05  ,  0.8237E+05  ,  0.8613E+05  ,  0.8934E+05  ,  0.9204E+05  ,  0.9432E+05  ,  0.9621E+05  ,  0.9777E+05  ,  0.9902E+05  ,  0.1000E+06  ,  0.1008E+06  ,  0.1013E+06  /)
  
  ! input liq_wat
  ql = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.2693E-06  ,  0.9935E-05  ,  0.7590E-06  ,  0.6236E-07  ,  0.1353E-06  ,  0.1564E-06  ,  0.3790E-08  ,  0.4378E-09  ,  0.1834E-09  ,  0.1335E-09  ,  0.1147E-09  ,  0.1056E-09  /)
  
  ! input ice_wat
  qi = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! input cld_amt
  cldfra_bl1d = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.3210E-02  ,  0.9685E-01  ,  0.1999E-01  ,  0.1164E-01  ,  0.1632E-01  ,  0.2544E-01  ,  0.6185E-03  ,  0.7144E-04  ,  0.2993E-04  ,  0.2178E-04  ,  0.1872E-04  ,  0.1723E-04  /)
  
  !------ cmf -----
  ! cmf_uws 
  cmf_uws = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.1030E-04  ,  0.1194E-04  ,  0.1395E-04  ,  0.1836E-04  ,  0.2864E-04  ,  0.2066E-04  ,  0.1415E-04  ,  0.8940E-05  ,  0.4888E-05  ,  0.1941E-05  ,  0.0000E+00  /)
  
  ! cmf_uwd 
  cmf_uwd = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.1001E-01  ,  0.1096E-01  ,  0.1024E-01  ,  0.1007E-01  ,  0.1036E-01  ,  0.1121E-01  ,  0.1279E-01  ,  0.9225E-02  ,  0.6315E-02  ,  0.3991E-02  ,  0.2182E-02  ,  0.8667E-03  ,  0.0000E+00  /)
  
  !======== output argument from uw_conv ============
  
  !------ qa -----
  ! qadt_uws 
  qadt_uws = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.6888E-09  ,  0.7498E-08  ,  0.7426E-08  ,  0.6676E-08  ,  0.1039E-07  ,  0.2359E-07  ,  0.3627E-07  ,  0.6001E-10  , -0.1668E-08  , -0.2483E-09  , -0.6098E-10  ,  0.0000E+00  /)
  
  ! qadet_uws
  qadet_uws = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.9239E-08  ,  0.5200E-08  ,  0.6346E-08  ,  0.1066E-07  ,  0.2451E-07  ,  0.3310E-07  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! qasub_uws
  qasub_uws = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.6888E-09  , -0.1741E-08  ,  0.2226E-08  ,  0.3307E-09  , -0.2735E-09  , -0.9232E-09  ,  0.3173E-08  ,  0.6001E-10  , -0.1668E-08  , -0.2483E-09  , -0.6098E-10  ,  0.0000E+00  /)
  
  ! qadt_uwd
  qadt_uwd = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.7259E-05  ,  0.1709E-05  , -0.1510E-05  ,  0.2995E-05  ,  0.1567E-05  ,  0.1895E-05  ,  0.3227E-05  ,  0.5780E-05  ,  0.2679E-07  ,  0.1668E-08  ,  0.2483E-09  ,  0.6098E-10  ,  0.0000E+00  /)
  
  ! qadet_uwd
  qadet_uwd = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.7240E-05  ,  0.1774E-05  ,  0.7140E-06  ,  0.9613E-06  ,  0.1306E-05  ,  0.2078E-05  ,  0.3698E-05  ,  0.4364E-05  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! qasub_uwd
  qasub_uwd = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.1863E-07  , -0.6548E-07  , -0.2224E-05  ,  0.2034E-05  ,  0.2611E-06  , -0.1827E-06  , -0.4717E-06  ,  0.1417E-05  ,  0.2679E-07  ,  0.1668E-08  ,  0.2483E-09  ,  0.6098E-10  ,  0.0000E+00  /)
  
  !------ ql -----
  ! qldt_uws 
  qldt_uws = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.7110E-13  ,  0.5227E-11  ,  0.5855E-11  ,  0.6084E-11  ,  0.7749E-11  ,  0.9430E-11  ,  0.3094E-11  ,  0.3677E-15  ,  0.2289E-16  ,  0.3408E-17  ,  0.8370E-18  ,  0.0000E+00  /)
  
  ! qldet_uws
  qldet_uws = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.5418E-11  ,  0.5590E-11  ,  0.6057E-11  ,  0.7754E-11  ,  0.9432E-11  ,  0.3075E-11  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! qlsub_uws
  qlsub_uws = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.7110E-13  , -0.1906E-12  ,  0.2658E-12  ,  0.2757E-13  , -0.4259E-14  , -0.2130E-14  ,  0.1950E-13  ,  0.3677E-15  ,  0.2289E-16  ,  0.3408E-17  ,  0.8370E-18  ,  0.0000E+00  /)
  
  ! qldt_uwd
  qldt_uwd = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.6097E-08  ,  0.2894E-08  ,  0.9499E-09  ,  0.1563E-08  ,  0.1463E-08  ,  0.1591E-08  ,  0.1433E-08  ,  0.4141E-09  ,  0.1642E-12  ,  0.1022E-13  ,  0.1521E-14  ,  0.3737E-15  ,  0.0000E+00  /)
  
  ! qldet_uwd
  qldet_uwd = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.6095E-08  ,  0.2900E-08  ,  0.1179E-08  ,  0.1320E-08  ,  0.1441E-08  ,  0.1594E-08  ,  0.1434E-08  ,  0.4054E-09  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! qlsub_uwd
  qlsub_uwd = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.1562E-11  , -0.5492E-11  , -0.2295E-09  ,  0.2428E-09  ,  0.2176E-10  , -0.2845E-11  , -0.1088E-11  ,  0.8706E-11  ,  0.1642E-12  ,  0.1022E-13  ,  0.1521E-14  ,  0.3737E-15  ,  0.0000E+00  /)
  
  !------ qi -----
  ! qidt_uws 
  qidt_uws = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! qidet_uws
  qidet_uws = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! qisub_uws
  qisub_uws = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! qidt_uwd
  qidt_uwd = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! qidet_uwd
  qidet_uwd = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)
  
  ! qisub_uwd
  qisub_uwd = (/    0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  ,  0.0000E+00  /)


  !@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  !elseif (choice_profile.eq.) then

  else
    print*,'ERROR: upsupported profile'
    stop
  endif




  if (conv.eq."s") then
    cmf(:) = cmf_uws(:)
  elseif (conv.eq."d") then
    cmf(:) = cmf_uwd(:)
  else
    print*,"ERROR: conv must be s or d"
    stop
  endif

!print*,'cmf_uws',cmf_uws
!print*,'cmf__in',cmf
!print*,'qasub_uws',qasub_uws
!print*,'cldfra_bl1d',cldfra_bl1d
!stop

  !--- reverse the array 
  call flip_array(kts,kte+1,zw) 
  call flip_array(kts,kte+1,cmf) 
  call flip_array(kts,kte,zfull) 
  call flip_array(kts,kte,tb) 
  call flip_array(kts,kte,pmid) 
  call flip_array(kts,kte,qv) 
  call flip_array(kts,kte,ql) 
  call flip_array(kts,kte,qi) 
  call flip_array(kts,kte,qc) 
  call flip_array(kts,kte,cldfra_bl1d) 

!-------------------

  print*,'hello world'

  call edmf_JPL( &
              kts, kte, zw, tb, pmid,     &
              qv,qc,ql,qi,cldfra_bl1d, cmf, &
              Qql_adv,Qqi_adv,Qa_adv, Qql_eddy,Qqi_eddy,Qa_eddy, &
              Qql_ent,Qqi_ent,Qa_ent, Qql_det,Qqi_det,Qa_det, Qql_sub,Qqi_sub,Qa_sub)

  call flip_array(kts,kte,Qa_sub)
  call flip_array(kts,kte,Qql_sub)
  call flip_array(kts,kte,Qqi_sub)

  call flip_array(kts,kte,ql) 
  call flip_array(kts,kte,qi) 
  call flip_array(kts,kte,cldfra_bl1d) 

  call flip_array(kts,kte+1,cmf) 

  !do_print = .false.
  !do_print = .true.

 
    !choice_profile=1 ; if (choice_profile.eq.1) conv = "s"
  if (do_print) then
    print*,'--------------'
    print*,'choice_profile, ',choice_profile
    print*,'conv, ',conv
    print*,'--------------'

        write(6,*)    '; Qa_sub'
        write(6,3002) '  Qa_sub = (/'    , Qa_sub 
        write(6,*)    ''
        write(6,*)    '; Qql_sub'
        write(6,3002) '  Qql_sub = (/'    , Qql_sub 
        write(6,*)    ''
        write(6,*)    '; Qqi_sub'
        write(6,3002) '  Qqi_sub = (/'    , Qqi_sub 
        write(6,*)    ''

    print*,'cmf',cmf
  
    if (conv.eq."s") then
      print*,'-----------------------'
      print*,'cldfra_bl1d',cldfra_bl1d
      print*,'qasub_uws',qasub_uws
      print*,'Qa_sub   ',Qa_sub
    
      print*,'-----------------------'
      print*,'ql',ql
      print*,'ql_uws',qlsub_uws
      print*,'Qql_sub   ',Qql_sub
    
      print*,'-----------------------'
      print*,'qi',qi
      print*,'qi_uws',qisub_uws
      print*,'Qqi_sub   ',Qqi_sub
    endif

    if (conv.eq."d") then
      print*,'-----------------------'
      print*,'cldfra_bl1d',cldfra_bl1d
      print*,'qasub_uwd',qasub_uwd
      print*,'Qa_sub   ',Qa_sub
    
      print*,'-----------------------'
      print*,'ql',ql
      print*,'ql_uwd',qlsub_uwd
      print*,'Qql_sub   ',Qql_sub
    
      print*,'-----------------------'
      print*,'qi',qi
      print*,'qi_uwd',qisub_uwd
      print*,'Qqi_sub   ',Qqi_sub
    endif
  endif ! end if of do_print

  stop

3000 format (A35,2X,F10.3,',')
3001 format (A35,2X,34(F10.3,2X,','))
3002 format (A35,2X,34(E12.4,2X,','))
3003 format (A35,2X,E12.4,',')
3004 format (A35,2X,33(F10.3,2X,','),A5)

end program test111

!###############################

SUBROUTINE edmf_JPL( &
              kts, kte, zw, tb, pmid,     &
              qv,qc,ql,qi,cldfra_bl1d, cmf, &
              Qql_adv,Qqi_adv,Qa_adv, Qql_eddy,Qqi_eddy,Qa_eddy, &
              Qql_ent,Qqi_ent,Qa_ent, Qql_det,Qqi_det,Qa_det, Qql_sub,Qqi_sub,Qa_sub)

        implicit none
        integer, parameter :: NUP = 1
        INTEGER, intent(in) :: KTS,KTE !, kpbl
        real, parameter :: rdgas  = 287.04
        real, parameter :: rvgas = 461.50
        real, parameter :: d622   = rdgas/rvgas
        real, parameter :: d378   = 1.-d622
        real, parameter :: d608   = d378/d622

        REAL,DIMENSION(KTS:KTE+1), intent(in) :: cmf
        REAL,DIMENSION(KTS:KTE), intent(in)   :: tb, pmid, QV,QC, QL, QI, cldfra_bl1d
       
        REAL,DIMENSION(KTS:KTE) :: U,V,TH,THL,TK,QT !,QV,QC, QL, QI  ! yhc add QL, QI
        REAL,DIMENSION(KTS:KTE) :: THV,P,exner,rho,liquid_frac
        ! zw .. heights of the updraft levels (edges of boxes)
        REAL,DIMENSION(KTS:KTE+1) :: ZW
        REAL :: DT,UST,PS,WTHL,WQT,PBLH


   !     LOGICAL :: cloudflg
    ! outputs
    !     REAL,DIMENSION(KTS:KTE) :: DTH,DQV,DQC,DU,DV

        ! REAL,DIMENSION(KTS:KTE) :: dry_a, moist_a,dry_w,moist_w, &
        !        dry_qt,moist_qt,dry_thl,moist_thl, dry_ent, moist_ent, moist_qc
    ! outputs - updraft properties
        REAL,DIMENSION(KTS:KTE) :: edmf_a,edmf_w,        &
                      & edmf_qt,edmf_thl, edmf_ent,edmf_qc, &
                      & edmf_debug1, edmf_debug2, edmf_debug3, edmf_debug4
    ! output
        INTEGER :: ktop
        REAL :: ztop

    ! outputs - variables needed for solver (s_aw - sum ai*wi, s_awphi - sum ai*wi*phii)
        REAL,DIMENSION(KTS:KTE+1) :: s_aw, s_awthl, s_awqt, s_awu, s_awv, s_awqc, s_awqv, s_awqke, s_aw2
        REAL,DIMENSION(KTS:KTE) :: qc_bl1d !, cldfra_bl1d

      REAL,DIMENSION(KTS:KTE) :: Qql,Qqi,Qa, &
        Qql_det,Qqi_det,Qa_det, Qql_sub,Qqi_sub,Qa_sub, &
        Qql_adv,Qqi_adv,Qa_adv, Qql_eddy,Qqi_eddy,Qa_eddy, Qql_ent,Qqi_ent,Qa_ent

        !INTEGER, PARAMETER :: NUP=100, debug_mf=0 !fixing number of plumes to 10
        INTEGER, PARAMETER :: debug_mf=0 !fixing number of plumes to 10, yhc - move NUP to namelist parameter

    ! updraft properties
        REAL,DIMENSION(KTS:KTE+1,1:NUP) :: UPW,UPTHL,UPQT,UPQC,UPA,UPU,UPV,UPTHV,UPRHO

    ! entrainment variables
        REAl,DIMENSION(KTS:KTE,1:NUP) :: ENT,ENTf
        REAL,DIMENSION(KTS:KTE) :: L0s
        INTEGER,DIMENSION(KTS:KTE,1:NUP) :: ENTi

        REAl,DIMENSION(KTS:KTE,1:NUP) :: DET
        REAL,DIMENSION(KTS:KTE) :: edmf_det

    ! internal variables
        INTEGER :: K,I, qlTop
        REAL :: wthv,wstar,qstar,thstar,sigmaW,sigmaQT,sigmaTH,z0, &
            pwmin,pwmax,wmin,wmax,wlv,wtv,dthv_dz
        REAL :: B,QTn,THLn,THVn,UPAn,QCn,Un,Vn,Wn2,EntEXP,EntW, deltaZ,EntExp_M, Beta_un, Z00, Z_i

    ! VARIABLES FOR CHABOUREAU-BECHTOLD CLOUD FRACTION
        ! REAL,DIMENSION(KTS:KTE) :: vt, vq, sgm
        REAL :: sigq,xl,tlk,qsat_tl,rsl,cpm,a,qmq,mf_cf,diffqt,&
               Fng,qww,alpha,beta,bb,f,pt,t,q2p,b9,satvp,rhgrid
        
        REAL,DIMENSION(kts:kte) :: ph,lfh 
        REAL :: &
          F1_ql, F1_qi, F2_ql, F2_qi, F3_ql, F3_qi, &
          THVsrfF,QTsrfF,maxS,stabF,dz,F0,F1,F2,F3,CCp1,CCp0,mf,mfp1  
        INTEGER, DIMENSION(2) :: seedmf
    ! w parameters
        REAL,PARAMETER :: &
            &Wa=1., &
            &Wb=1.5

    ! entrainment parameters
        REAL,PARAMETER :: &
        !& L0=100.,&    yhc move L0 to namelist paramter 
        & ENT0=0.2
       ! maximum wind speed in updraft
       REAL,PARAMETER :: MAXW=2.  

    !<--- yhc 2021-09-08
    !  naming convention: 
    !     a: fractional area (none)
    !    mf: mass flux (kg/m2/s)
    !    qv: specific humifity (kg/kg)
    !    moist/dry/all: moist updrafts, dry updrafts, or combined (moist+dry) updrafts
    !    full/half: on full levels (where T,q are defined) to half levels (those levels in between full levels)
       REAL,DIMENSION(kts:kte+1) :: & 
         num_updraft  , &
         a_moist_half , &   
         a_dry_half   , &        
         mf_moist_half, &     
         mf_dry_half  , &
         mf_all_half  , & 
         qv_moist_half, &     
         qv_dry_half  

       REAL,DIMENSION(kts:kte) :: & 
         num_DET, num_nDET_zENT, num_nDET_pENT,  &
         a_moist_full ,  &
         a_dry_full ,  &
         mf_moist_full,  &
         mf_dry_full  ,  & 
         mf_all_full  , & 
         qv_moist_full,  & 
         qv_dry_full   
  
       REAL,DIMENSION(KTS:KTE) :: &
         ZFULL, ice_frac

       REAL :: &
         qcp0, qcp1, qlp0, qlp1, qip0, qip1, cldp1, cldp0, det_temp

       REAl,DIMENSION(KTS:KTE,1:NUP) :: &
        Qql_det_i, Qqi_det_i, Qa_det_i, Qql_sub_i , Qqi_sub_i , Qa_sub_i, &
        Qql_adv_i, Qqi_adv_i, Qa_adv_i, Qql_eddy_i, Qqi_eddy_i, Qa_eddy_i, Qql_ent_i, Qqi_ent_i, Qa_ent_i

       integer, parameter :: rx = 500  ! AM4 random number generator
       real :: rr(rx)

       logical :: do_MF

    !   type(randomNumberStream) :: streams1
    !---> yhc 2021-09-08 

! stability parameter for massflux
! (mass flux is limited so that dt/dz*a_i*w_i<UPSTAB)
!       REAL,PARAMETER :: UPSTAB=1.   ! yhc - move UPSTAB to namelist parameter

!Initialize values:
ktop = 0
ztop = 0.0

UPW=0.
UPRHO=0.
UPTHL=0.
UPTHV=0.
UPQT=0.
UPA=0.
UPU=0.
UPV=0.
UPQC=0.
ENT=0.
L0s=100.

!wthv=wthl+svp1*wqt
wthv = 1.

! Initialize mean updraft properties
edmf_a  =0.
edmf_w  =0.
edmf_qt =0.
edmf_thl=0.
edmf_ent=0.
edmf_qc =0.

edmf_debug1 = 0.
edmf_debug2 = 0.
edmf_debug3 = 0.
edmf_debug4 = 0.

s_aw=0.
s_awthl=0.
s_awqt=0.
s_awqv=0.
s_awqc=0.
s_awu=0.
s_awv=0.
s_awqke=0.


 Qql=0.
 Qqi=0. 
 Qa=0. 

 Qql_adv  = 0.
 Qqi_adv  = 0.
 Qa_adv  = 0.

 Qql_eddy = 0.
 Qqi_eddy = 0.
 Qa_eddy = 0.

 Qql_ent  = 0.
 Qqi_ent  = 0.
 Qa_ent  = 0.

 Qql_det  = 0.
 Qqi_det  = 0.
 Qa_det  = 0.

 Qql_sub  = 0.
 Qqi_sub  = 0.
 Qa_sub  = 0.

 Qql_adv_i = 0.
 Qqi_adv_i = 0.
 Qa_adv_i = 0.

 Qql_eddy_i = 0.
 Qqi_eddy_i = 0.
 Qa_eddy_i = 0.

 Qql_ent_i = 0.
 Qqi_ent_i = 0.
 Qa_ent_i = 0.

 Qql_det_i = 0.
 Qqi_det_i = 0.
 Qa_det_i = 0.

 Qql_sub_i = 0.
 Qqi_sub_i = 0.
 Qa_sub_i = 0.

 edmf_det = 0.
 DET=0.

 ice_frac(:) = 1. - liquid_frac(:)

!<--- yhc 2021-09-08

 rho(:) = pmid(:) / rdgas / (tb(:)*(qv(:)*d608+1.0))
!print*,'rho',rho
!stop

!--- compute z at full levels (where T,q are defined)
DO K=KTS,KTE
  ZFULL(K) = 0.5 * (ZW(K)+ZW(K+1))
ENDDO

!print*,'cmf',cmf
!stop

!--- compute variables for coupling with Tiedtke
DO K=KTS,KTE-1
  DO I=1,NUP
  !DO I=1,1
     dz=ZW(k+1)-ZW(k)
   
     !--- mass flux 
     mfp1= cmf(K+1) !UPRHO(K+1,I) * UPA(K+1,I) * UPW(K+1,I)   ! mass flux at k+1/2 level
     mf  = cmf(K)   !UPRHO(K,I)   * UPA(K,I)   * UPW(K,I)     ! mass fkyx at k-1/2 level

!print*,'k,mf,mfp1',k,mf,mfp1

     qcp1 = 0.5 * (qc(K)+qc(K+1))                   ! grid-scale qc at k+1/2 level
     if (K.eq.1) then
       qcp0 = qc(K)                                 ! grid-scale qc at k-1/2 level
     else
       qcp0 = 0.5 * (qc(K)+qc(K-1))                 ! grid-scale qc at k-1/2 level
     endif

     qlp1 = 0.5 * (ql(K)+ql(K+1))                   ! grid-scale ql at k+1/2 level
     if (K.eq.1) then
       qlp0 = ql(K)                                 ! grid-scale ql at k-1/2 level
     else
       qlp0 = 0.5 * (ql(K)+ql(K-1))                 ! grid-scale ql at k-1/2 level
     endif

     qip1 = 0.5 * (qi(K)+qi(K+1))                   ! grid-scale qi at k+1/2 level
     if (K.eq.1) then
       qip0 = qi(K)                                 ! grid-scale qi at k-1/2 level
     else
       qip0 = 0.5 * (qi(K)+qi(K-1))                 ! grid-scale qi at k-1/2 level
     endif

     cldp1 = 0.5 * (cldfra_bl1d(K)+cldfra_bl1d(K+1))          ! grid-scale cloud fraction at k+1/2 level
     if (K.eq.1) then
       cldp0 = cldfra_bl1d(K)                                 ! grid-scale cloud fraction at k-1/2 level
     else
       cldp0 = 0.5 * (cldfra_bl1d(K)+cldfra_bl1d(K-1))        ! grid-scale cloud fraction at k-1/2 level
     endif

     !--- saturated fraction
     IF (UPQC(K+1,I) > 0.) THEN    ! saturated fraction at k+1/2 level
       CCp1=1.
     ELSE
       CCp1=0.
     ENDIF
   
     IF (UPQC(K,I) > 0.) THEN      ! saturated fraction at k-1/2 level
       CCp0=1.
     ELSE
       CCp0=0.
     ENDIF

!print*,'k,mf,mfp1',k,mf,mfp1
!print*,'k,qlp0,qlp1',k,qlp0,qlp1
!print*,'k,qip0,qip1',k,qip0,qip1
!print*,'k,rho',k,rho(k)

     !************************
     !************************
     !
     !  eddy-flux/source form
     !
     !************************
     !************************

       !-----------------------------------------------
       !--- cloud condensate, eddy-flux/source form ---
       !-----------------------------------------------
       F1=0. ; F1_ql=0. ; F1_qi=0.
       F2=0. ; F2_ql=0. ; F2_qi=0.
       F3=0. ; F3_ql=0. ; F3_qi=0.

       !if (Qx_numerics.eq.1) then   ! upwind approximation
         !--- F1: eddy-flux convergence term for cloud condensate
         !if (K.eq.1) then
           !F1 = -1./rho(k) * ( mfp1*(UPQC(K+1,I)-qcp1) - mf*(UPQC(K,I)-0.) )  / dz     ! qc(K-1)=qc(0)=0.
         !  F1_ql = -1./rho(k) * ( mfp1 * (liquid_frac(k+1)*UPQC(K+1,I)-qlp1) - mf * (liquid_frac(k)*UPQC(K,I)-0.) )  / dz     ! qc(K-1)=qc(0)=0.
         !  F1_qi = -1./rho(k) * ( mfp1 * (ice_frac   (k+1)*UPQC(K+1,I)-qip1) - mf * (ice_frac   (k)*UPQC(K,I)-0.) )  / dz     ! qc(K-1)=qc(0)=0.
         !else
           !F1 = -1./rho(k) * ( mfp1*(UPQC(K+1,I)-qcp1) - mf*(UPQC(K,I)-qcp0)) / dz
           F1_ql = -1./rho(k) * ( mfp1 * (liquid_frac(k+1)*UPQC(K+1,I)-qlp1) - mf * (liquid_frac(k)*UPQC(K,I)-qlp0) )  / dz     ! qc(K-1)=qc(0)=0.
           F1_qi = -1./rho(k) * ( mfp1 * (ice_frac   (k+1)*UPQC(K+1,I)-qip1) - mf * (ice_frac   (k)*UPQC(K,I)-qip0) )  / dz     ! qc(K-1)=qc(0)=0.
         !endif
  
         if (UPW(K,I).gt.0. .and. UPW(K+1,I).gt.0.) then  ! source terms are only present in the plume
           !--- F2: source/vertical advection term for cloud condensate
           !F2 = UPA(K,I) * UPW(K,I) * (UPQC(K+1,I)-UPQC(K,I)) / dz  !+ENT(K,I)*mf*(UPQC(K,I)-qc(K))
           F2_ql = UPA(K,I) * UPW(K,I) * (liquid_frac(K+1)*UPQC(K+1,I)-liquid_frac(K)*UPQC(K,I)) / dz  !+ENT(K,I)*mf*(UPQC(K,I)-qc(K))
           F2_qi = UPA(K,I) * UPW(K,I) * (ice_frac   (K+1)*UPQC(K+1,I)-ice_frac   (K)*UPQC(K,I)) / dz  !+ENT(K,I)*mf*(UPQC(K,I)-qc(K))
    
           !--- F3: source/entrainment term for cloud condensate
           F3_ql = UPA(K,I) * UPW(K,I) * ENT(K,I) * (liquid_frac(K)*UPQC(K,I)-ql(K))
           F3_qi = UPA(K,I) * UPW(K,I) * ENT(K,I) * (ice_frac   (K)*UPQC(K,I)-qi(K))
         endif
       !endif  ! end if of Qx_numerics   

         Qql_eddy_i (K,I) = F1_ql !liquid_frac(k)*F1
         Qql_adv_i  (K,I) = F2_ql !liquid_frac(k)*F2
         Qql_ent_i  (K,I) = F3_ql !liquid_frac(k)*F3
    
         Qqi_eddy_i (K,I) = F1_qi !(1.-liquid_frac(k))*F1
         Qqi_adv_i  (K,I) = F2_qi !(1.-liquid_frac(k))*F2
         Qqi_ent_i  (K,I) = F3_qi !(1.-liquid_frac(k))*F3

         !--- sum over the i-th plume
         Qql_eddy(k) = Qql_eddy(k) + Qql_eddy_i (K,I)
         Qql_adv (k) = Qql_adv (k) + Qql_adv_i  (K,I)
         Qql_ent (k) = Qql_ent (k) + Qql_ent_i  (K,I)

         Qqi_eddy(k) = Qqi_eddy(k) + Qqi_eddy_i (K,I)
         Qqi_adv (k) = Qqi_adv (k) + Qqi_adv_i  (K,I)
         Qqi_ent (k) = Qqi_ent (k) + Qqi_ent_i  (K,I)

       !---------------------------------------------
       !--- cloud fraction, eddy-flux/source form ---
       !---------------------------------------------
       F1=0. ; F1_ql=0. ; F1_qi=0.
       F2=0. ; F2_ql=0. ; F2_qi=0.
       F3=0. ; F3_ql=0. ; F3_qi=0.

       !if (Qx_numerics.eq.1) then   ! upwind approximation
         !--- F1: eddy-flux convergence term for cloud fraction
         !if (K.eq.1) then
         !  Qa_eddy_i (K,I) = -1./rho(k) * ( mfp1*(CCp1-cldp1) - mf*(CCp0-0.)    ) / dz     ! qc(K-1)=qc(0)=0.
         !else
           Qa_eddy_i (K,I) = -1./rho(k) * ( mfp1*(CCp1-cldp1) - mf*(CCp0-cldp0) ) / dz
         !endif

         if (UPW(K,I).gt.0. .and. UPW(K+1,I).gt.0.) then  ! source terms are only present in the plume
           !--- F2: vertical advection term
           Qa_adv_i (K,I) = UPA(K,I) * UPW(K,I) * (CCp1-CCp0) / dz  !+ENT(K,I)*mf*(UPQC(K,I)-qc(K))
    
           !--- F3: entrainment term
           Qa_ent_i (K,I) = UPA(K,I) * UPW(K,I) * ENT(K,I) * (CCp0-cldfra_bl1d(K))
         endif
       !endif  ! end if of Qx_numerics   
  
         Qa_eddy(k) = Qa_eddy(k) + Qa_eddy_i (K,I)
         Qa_adv (k) = Qa_adv (k) + Qa_adv_i  (K,I)
         Qa_ent (k) = Qa_ent (k) + Qa_ent_i  (K,I)

     !************************
     !************************
     !
     !  detrainment/subsidence form
     !
     !************************
     !************************

       !-----------------------------------------------------
       !--- cloud condensate, detrainment/subsidence form ---
       !-----------------------------------------------------
       F1=0. ; F1_ql=0. ; F1_qi=0.
       F2=0. ; F2_ql=0. ; F2_qi=0.
       F3=0. ; F3_ql=0. ; F3_qi=0.

       !if (Qx_numerics.eq.1) then   ! upwind approximation
         ! F1: subsidence term for cloud condensate
         !F1 = mfp1/rho(k) * (qc(K+1)-qc(K))/(ZFULL(K+1)-ZFULL(K))  
         F1_ql = mfp1/rho(k) * (ql(K+1)-ql(K))/(ZFULL(K+1)-ZFULL(K))  
         F1_qi = mfp1/rho(k) * (qi(K+1)-qi(K))/(ZFULL(K+1)-ZFULL(K))  

!print*,'k,F1_ql',k,F1_ql
!print*,'k,mfp1,ql(K+1),ql(K)',k,mfp1,ql(K+1),ql(K)

         ! F2: detrainment term for cloud condensate
         !F2 = mf*DET(K,I)/rho(k) * (UPQC(K,I)-qc(K))
         F2_ql = mf*DET(K,I)/rho(k) * (liquid_frac(K)*UPQC(K,I)-ql(K))
         F2_qi = mf*DET(K,I)/rho(k) * (ice_frac   (K)*UPQC(K,I)-qi(K))
       !endif  ! end if of Qx_numerics   

         Qql_sub_i (K,I) = F1_ql !liquid_frac(k)*F1
         Qql_det_i (K,I) = F2_ql !liquid_frac(k)*F2

         Qqi_sub_i (K,I) = F1_qi !(1.-liquid_frac(k))*F1
         Qqi_det_i (K,I) = F2_qi !(1.-liquid_frac(k))*F2

       ! sum over all plumes
       Qql_sub(k) = Qql_sub(k) + Qql_sub_i (K,I)
       Qqi_sub(k) = Qqi_sub(k) + Qqi_sub_i (K,I)

       Qql_det(k) = Qql_det(k) + Qql_det_i (K,I)
       Qqi_det(k) = Qqi_det(k) + Qqi_det_i (K,I)

       !---------------------------------------------------
       !--- cloud fraction, detrainment/subsidence form ---
       !---------------------------------------------------
       F1=0. ; F1_ql=0. ; F1_qi=0.
       F2=0. ; F2_ql=0. ; F2_qi=0.
       F3=0. ; F3_ql=0. ; F3_qi=0.

       !if (Qx_numerics.eq.1) then   ! upwind approximation
         ! F1: subsidence term for cloud condensate
         Qa_sub_i (K,I) = mfp1/rho(k) * (cldfra_bl1d(K+1)-cldfra_bl1d(K))/(ZFULL(K+1)-ZFULL(K))  

         ! F2: detrainment term for cloud condensate
         Qa_det_i (K,I) = mf*DET(K,I)/rho(k) * (CCp0-cldfra_bl1d(K))
       !endif  ! end if of Qx_numerics   

       ! sum over all plumes
       Qa_sub(k) = Qa_sub(k) + Qa_sub_i (K,I)
       Qa_det(k) = Qa_det(k) + Qa_det_i (K,I)

  ENDDO
ENDDO  

!print*,'Qa_sub',Qa_sub
!print*,'Ql_sub',Qql_sub
!print*,'Qi_sub',Qqi_sub


!if (Qx_MF.eq.1) then   ! eddy-divergence/source form 
!  Qql(:) = Qql_eddy(:) + Qql_adv(:) +Qql_ent(:) 
!  Qqi(:) = Qqi_eddy(:) + Qqi_adv(:) +Qqi_ent(:) 
!  Qa (:) = Qa_eddy (:) + Qa_adv (:) +Qa_ent (:) 
!
!elseif (Qx_MF.eq.2) then ! detrainment/subsidence form
!  Qql(:) = Qql_det(:) + Qql_sub(:)
!  Qqi(:) = Qqi_det(:) + Qqi_sub(:)
!  Qa (:) = Qa_det (:) + Qa_sub (:)
!
!else
!  print*,'ERROR: Qx_MF must be 1 or 2'
!endif

3001 format (A35,2X,34(F10.3,2X,','))
3002 format (A35,2X,34(E12.4,2X,','))

END SUBROUTINE edmf_JPL

!======================

subroutine flip_array(ks,ke,aa)
  implicit none

  integer, intent(in) :: ks, ke

  !real, dimension(:), intent(inout) :: aa
  real, dimension(ks:ke) :: aa
  !real, dimension(:) :: aa

  real, dimension(ks:ke) :: aa_origin
  real, dimension(ks:ke) :: aa_flip

  real dum1, dum2
  integer i,k,nn
!-------------------

!print*,'hihi'

  nn=size(aa)

!print*,'aa',aa
!print*,'nn',nn

  aa_origin(:) = aa(:) 
  
  do k=1,nn
    i=nn-k+1
    aa(i) = aa_origin(k)
  enddo

end subroutine



