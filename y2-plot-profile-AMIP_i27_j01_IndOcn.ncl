load "$NCARG_ROOT/lib/ncarg/nclscripts/csm/gsn_code.ncl"
load "$NCARG_ROOT/lib/ncarg/nclscripts/wrf/WRFUserARW.ncl"
load "$NCARG_ROOT/lib/ncarg/nclscripts/csm/gsn_csm.ncl"
load "$NCARG_ROOT/lib/ncarg/nclscripts/csm/contributed.ncl"
load "$NCARG_ROOT/lib/ncarg/nclscripts/csm/shea_util.ncl"
load "/ncrc/home2/Yi-hsuan.Chen//script/ncl//ignorantNCL.ncl"
;load "./ignorantNCL.ncl"
load "/ncrc/home2/Yi-hsuan.Chen//script/ncl//ignorantNCL-colormaps.ncl"
;load "zz-read_parameters.ncl"

begin
  tiMainString = "Column, AMIP_i27_j01_IndOcn"
  dt = 1800.

  ;option_th = "th_dt30min"
  ;option_var = "xxx"

;--- share profile ----
  z_full  = (/   42071.364  , 34373.959  , 30112.024  , 27031.458  , 24654.524  , 22754.480  , 21076.119  , 19439.853  , 17819.938  , 16235.222  , 14696.781  , 13201.501  , 11742.933  , 10318.049  ,  8932.107  ,  7603.045  ,  6362.974  ,  5252.086  ,  4294.967  ,  3489.846  ,  2820.033  ,  2264.217  ,  1803.666  ,  1423.346  ,  1110.039  ,   852.399  ,   641.204  ,   468.787  ,   328.964  ,   217.155  ,   129.600  ,    63.838  ,    18.119  /)
  
  p_full  = 0.01 * (/     216.404  ,   584.531  ,  1074.508  ,  1710.654  ,  2511.381  ,  3522.120  ,  4813.790  ,  6459.750  ,  8530.333  , 11090.686  , 14201.684  , 17922.706  , 22310.144  , 27412.777  , 33257.109  , 39796.435  , 46834.517  , 54011.240  , 60928.429  , 67307.590  , 73027.672  , 78066.649  , 82446.669  , 86211.595  , 89418.857  , 92131.400  , 94407.759  , 96300.910  , 97858.163  , 99117.189  ,100111.453  ,100863.047  ,101387.951  /)
  
  thl  = (/    1473.035  ,  1042.743  ,   834.681  ,   699.500  ,   573.950  ,   308.587  ,   289.640  ,   296.487  ,   302.232  ,   314.212  ,   324.487  ,   318.724  ,   324.485  ,   323.274  ,   320.678  ,   317.918  ,   316.088  ,   315.234  ,   313.281  ,   309.924  ,   307.062  ,   305.409  ,   303.764  ,   302.100  ,   300.724  ,   299.261  ,   298.116  ,   297.466  ,   297.049  ,   296.729  ,   296.603  ,   296.528  ,   296.521  /)
  
  qq  = (/    0.1736E-05  ,  0.1760E-05  ,  0.1754E-05  ,  0.1473E-05  ,  0.1953E-05  ,  0.1037E-03  ,  0.3360E-03  ,  0.6352E-03  ,  0.9513E-03  ,  0.1354E-02  ,  0.2010E-02  ,  0.2539E-02  ,  0.2917E-02  ,  0.3472E-02  ,  0.4198E-02  ,  0.4496E-02  ,  0.4505E-02  ,  0.5463E-02  ,  0.7016E-02  ,  0.7963E-02  ,  0.8925E-02  ,  0.1035E-01  ,  0.1180E-01  ,  0.1299E-01  ,  0.1358E-01  ,  0.1409E-01  ,  0.1465E-01  ,  0.1534E-01  ,  0.1608E-01  ,  0.1725E-01  ,  0.1757E-01  ,  0.1782E-01  ,  0.1808E-01  /)
  
  qt  = (/    0.1736E-05  ,  0.1760E-05  ,  0.1754E-05  ,  0.1473E-05  ,  0.1953E-05  ,  0.2234E-01  ,  0.2273E-01  ,  0.2158E-01  ,  0.1979E-01  ,  0.1598E-01  ,  0.1296E-01  ,  0.1303E-01  ,  0.1027E-01  ,  0.9637E-02  ,  0.9390E-02  ,  0.8625E-02  ,  0.7335E-02  ,  0.6562E-02  ,  0.7183E-02  ,  0.7978E-02  ,  0.8932E-02  ,  0.1036E-01  ,  0.1180E-01  ,  0.1299E-01  ,  0.1358E-01  ,  0.1409E-01  ,  0.1465E-01  ,  0.1534E-01  ,  0.1608E-01  ,  0.1725E-01  ,  0.1757E-01  ,  0.1782E-01  ,  0.1808E-01  /)
  
  tke_in = 0.5 * (/    0.1000E-03  ,  0.1000E-03  ,  0.1000E-03  ,  0.1000E-03  ,  0.1000E-03  ,  0.1000E-03  ,  0.1850E-03  ,  0.2976E-02  ,  0.4362E-02  ,  0.8159E-03  ,  0.6526E-03  ,  0.6317E-03  ,  0.4102E-03  ,  0.1351E-03  ,  0.1000E-03  ,  0.1000E-03  ,  0.1000E-03  ,  0.1000E-03  ,  0.2492E-03  ,  0.3872E-03  ,  0.7568E-03  ,  0.8774E-03  ,  0.1000E-03  ,  0.1000E-03  ,  0.1186E-03  ,  0.8824E-02  ,  0.6692E-01  ,  0.1804E+00  ,  0.4197E+00  ,  0.7561E+00  ,  0.8824E+00  ,  0.8172E+00  ,  0.7611E+00  /)
  
  ;--- from am4 ---
  
  ; turbulent kinetic energy (m2/s2)
  tke_am4 = (/    0.5000E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.1795E-03  ,  0.7836E-03  ,  0.5586E-03  ,  0.3984E-03  ,  0.2291E-03  ,  0.1671E-03  ,  0.1261E-03  ,  0.1085E-03  ,  0.5646E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.6171E-04  ,  0.8804E-04  ,  0.6380E-04  ,  0.8394E-04  ,  0.8639E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.4812E-03  ,  0.1326E-01  ,  0.6560E-01  ,  0.1308E+00  ,  0.2117E+00  ,  0.2477E+00  ,  0.2575E+00  ,  0.2545E+00  ,  0.2290E+00  /)
  
  ; u tendency from edmf_mynn (m/s2)
  udt_edmf_am4 = (/    0.0000E+00  , -0.2442E-08  , -0.4067E-08  , -0.1108E-07  ,  0.2263E-08  ,  0.7529E-07  , -0.7817E-07  ,  0.8018E-07  ,  0.5941E-07  , -0.5915E-07  , -0.1130E-07  ,  0.1488E-08  , -0.1072E-07  , -0.2196E-07  , -0.2040E-07  , -0.1178E-07  , -0.6345E-08  , -0.1929E-07  ,  0.5949E-08  ,  0.1081E-08  , -0.1437E-07  , -0.8249E-08  , -0.1479E-07  , -0.3290E-07  , -0.1452E-05  , -0.2440E-04  , -0.5851E-04  , -0.6647E-04  , -0.1456E-03  , -0.6714E-04  ,  0.3737E-04  ,  0.1408E-03  ,  0.2356E-03  /)
  
  ; v tendency from edmf_mynn (m/s2)
  vdt_edmf_am4 = (/    0.0000E+00  ,  0.1531E-10  ,  0.2743E-08  ,  0.8667E-08  , -0.1464E-07  , -0.2684E-07  , -0.8999E-07  ,  0.2538E-07  ,  0.7140E-07  ,  0.2344E-07  ,  0.7231E-08  ,  0.2441E-08  , -0.1706E-07  , -0.2404E-07  ,  0.1922E-08  ,  0.2139E-07  ,  0.3712E-07  ,  0.4188E-07  , -0.5556E-07  , -0.1852E-07  ,  0.3129E-08  , -0.1591E-07  , -0.6852E-08  ,  0.6564E-08  ,  0.9871E-07  , -0.1239E-05  , -0.1146E-04  , -0.2829E-04  , -0.4965E-04  , -0.1105E-04  ,  0.5051E-04  ,  0.1444E-03  ,  0.2497E-03  /)
  
  ; t tendency from edmf_mynn (K/s)
  tdt_edmf_am4 = (/    0.0000E+00  ,  0.1091E-08  , -0.1443E-08  , -0.1750E-07  ,  0.6869E-09  , -0.1296E-07  ,  0.2499E-06  , -0.1787E-06  ,  0.3279E-07  , -0.1108E-07  , -0.4779E-07  ,  0.2401E-07  , -0.1488E-07  , -0.9829E-09  ,  0.1553E-08  ,  0.1362E-08  , -0.5672E-09  , -0.1955E-07  ,  0.1660E-07  ,  0.4138E-08  , -0.4293E-09  , -0.4553E-09  , -0.2667E-08  , -0.4824E-08  , -0.1233E-06  , -0.1735E-05  , -0.4525E-05  , -0.7875E-05  , -0.3093E-04  ,  0.3855E-04  ,  0.8986E-04  ,  0.1491E-03  ,  0.1759E-03  /)
  
  ; q tendency from edmf_mynn (kg/kg/s)
  qdt_edmf_am4 = (/    0.0000E+00  , -0.1485E-19  , -0.8514E-18  ,  0.2411E-16  ,  0.6228E-12  ,  0.1236E-04  ,  0.1245E-04  ,  0.1165E-04  ,  0.1049E-04  ,  0.8148E-05  ,  0.6140E-05  ,  0.5887E-05  ,  0.4125E-05  ,  0.3458E-05  ,  0.2915E-05  ,  0.2318E-05  ,  0.1587E-05  ,  0.6172E-06  ,  0.9437E-07  , -0.5156E-07  ,  0.5221E-09  ,  0.2277E-08  ,  0.9919E-09  ,  0.1805E-09  ,  0.4505E-10  ,  0.8705E-09  ,  0.6306E-08  ,  0.2608E-07  ,  0.1790E-06  ,  0.3127E-08  ,  0.3242E-07  ,  0.1907E-07  , -0.6882E-07  /)
  

;--- from offline program ---
  ; turbulent kinetic energy (m2/s2)
  tke_off = (/    0.5000E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.1239E-03  ,  0.2006E-03  ,  0.1700E-03  ,  0.1980E-03  ,  0.7637E-04  ,  0.6753E-04  ,  0.9248E-04  ,  0.8489E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.6215E-04  ,  0.6361E-04  ,  0.8411E-04  ,  0.8645E-04  ,  0.5000E-04  ,  0.5000E-04  ,  0.4813E-03  ,  0.1326E-01  ,  0.6558E-01  ,  0.1307E+00  ,  0.2116E+00  ,  0.2475E+00  ,  0.2572E+00  ,  0.2540E+00  ,  0.2286E+00  /)
  
  ; u tendency from edmf_mynn (m/s2)
  udt_edmf_off = (/    0.0000E+00  , -0.2441E-08  , -0.4065E-08  , -0.1107E-07  , -0.2200E-08  ,  0.7582E-07  , -0.6436E-07  ,  0.4149E-07  ,  0.4760E-07  , -0.4088E-07  ,  0.6807E-08  ,  0.5044E-08  , -0.1182E-07  , -0.1968E-07  , -0.1721E-07  , -0.1090E-07  , -0.4292E-08  , -0.1297E-07  , -0.4581E-08  ,  0.6986E-09  , -0.1435E-07  , -0.8034E-08  , -0.1488E-07  , -0.3295E-07  , -0.1452E-05  , -0.2440E-04  , -0.5852E-04  , -0.6640E-04  , -0.1455E-03  , -0.6722E-04  ,  0.3739E-04  ,  0.1409E-03  ,  0.2354E-03  /)
  
  ; v tendency from edmf_mynn (m/s2)
  vdt_edmf_off = (/    0.0000E+00  ,  0.1534E-10  ,  0.2742E-08  ,  0.8663E-08  , -0.1413E-07  , -0.2525E-07  , -0.4591E-07  ,  0.2531E-07  ,  0.3151E-07  ,  0.1501E-07  ,  0.6724E-08  ,  0.2894E-08  , -0.1551E-07  , -0.2071E-07  , -0.7326E-10  ,  0.1986E-07  ,  0.3033E-07  ,  0.2788E-07  , -0.3107E-07  , -0.1812E-07  ,  0.3119E-08  , -0.1602E-07  , -0.6780E-08  ,  0.6588E-08  ,  0.9744E-07  , -0.1231E-05  , -0.1145E-04  , -0.2833E-04  , -0.4971E-04  , -0.1093E-04  ,  0.5061E-04  ,  0.1443E-03  ,  0.2496E-03  /)
  
  ; t tendency from edmf_mynn (K/s)
  tdt_edmf_off = (/    0.0000E+00  ,  0.1089E-08  , -0.1441E-08  , -0.1747E-07  ,  0.5423E-08  , -0.2042E-07  ,  0.9040E-08  ,  0.1833E-07  , -0.8143E-07  , -0.3985E-05  , -0.1853E-01  , -0.2159E-01  , -0.9296E-02  , -0.5810E-02  , -0.4327E-02  , -0.2040E-02  , -0.1603E-03  , -0.3430E-03  , -0.2596E-03  ,  0.1591E-03  , -0.9715E-06  , -0.6394E-05  , -0.2694E-05  , -0.4846E-06  , -0.1354E-06  , -0.1742E-05  , -0.4528E-05  , -0.7925E-05  , -0.3074E-04  ,  0.3841E-04  ,  0.8963E-04  ,  0.1493E-03  ,  0.1761E-03  /)
  
  ; q tendency from edmf_mynn (kg/kg/s)
  qdt_edmf_off = (/    0.0000E+00  , -0.1490E-19  , -0.8523E-18  ,  0.2406E-16  ,  0.5743E-14  ,  0.1255E-12  ,  0.1390E-12  , -0.1804E-12  ,  0.6790E-11  ,  0.4582E-09  ,  0.2462E-05  ,  0.3284E-05  ,  0.1599E-05  ,  0.1124E-05  ,  0.9362E-06  ,  0.4889E-06  ,  0.4213E-07  ,  0.9801E-07  ,  0.7971E-07  , -0.5179E-07  ,  0.3342E-09  ,  0.2277E-08  ,  0.9920E-09  ,  0.1806E-09  ,  0.4482E-10  ,  0.8663E-09  ,  0.6320E-08  ,  0.2634E-07  ,  0.1773E-06  ,  0.5491E-08  ,  0.3215E-07  ,  0.1728E-07  , -0.6733E-07  /)
  
  p_full@long_name = "pressure"
  p_full@units = "hPa"

  z_full@long_name = "height"
  z_full@units = "m"

;=====================
  yy = p_full
  trYMaxF = max(p_full)

  if (option_var.eq."thl") then
    trYLog = True
    xx = thl
    xx@long_name = "theta_li"
    xx@units = "K"
    labels_xy1 = "theta_li"
  end if

  ;option_var = "qall"
  if (option_var.eq."qall") then
    trYLog = True
    xx = (/qq,qt/)
    xx@long_name = "qv & qt"
    xx@units = "kg/kg"
    labels_xy1 = (/"qv","qt"/)
  end if

  ;option_var = "tke"
  if (option_var.eq."tke") then
    trYLog = False 
    xx = (/tke_in,tke_am4,tke_off/)
    xx@long_name = "TKE"
    xx@units = "m2/s2"
    labels_xy1 = (/"tke_input","tke_am4","tke_off"/)
  end if

  ;option_var = "tdt"
  if (option_var.eq."tdt") then
    trYLog = False 
    xx = dt * (/tdt_edmf_am4,tdt_edmf_off/)
    xx@long_name = "t tendency"
    xx@units = "K/step (30min)"
    labels_xy1 = (/"tdt_edmf_am4","tdt_edmf_off"/)
  end if

  ;option_var = "qdt"
  if (option_var.eq."qdt") then
    trYLog = True 
    xx = dt * (/qdt_edmf_am4,qdt_edmf_off/)
    xx@long_name = "q tendency"
    xx@units = "kg/kg/step (30min)"
    labels_xy1 = (/"qdt_edmf_am4","qdt_edmf_off"/)
  end if

  ;option_var = "udt"
  if (option_var.eq."udt") then
    trYLog = False 
    xx = dt * (/udt_edmf_am4,udt_edmf_off/)
    xx@long_name = "u tendency"
    xx@units = "m/s/step (30min)"
    labels_xy1 = (/"udt_edmf_am4","udt_edmf_off"/)
  end if

  ;option_var = "vdt"
  if (option_var.eq."vdt") then
    trYLog = False 
    xx = dt * (/vdt_edmf_am4,vdt_edmf_off/)
    xx@long_name = "v tendency"
    xx@units = "m/s/step (30min)"
    labels_xy1 = (/"vdt_edmf_am4","vdt_edmf_off"/)
  end if

print(xx)

;------------------
; general settings
;------------------

  wks_name = "test111_y2"+"-"+option_var
  wks_type = "png"  ; or x11,pdf,ncgm
  wks = gsn_open_wks(wks_type, wks_name)
  res = True

  res_xy1 = res
    res_xy1@trYReverse = True
    res_xy1@trYLog = trYLog
    res_xy1@xyMarkLineMode  = "MarkLines"
    res_xy1@tiMainString = tiMainString
  opt_xy1 = True
    opt_xy1@gsnString = "x"
    opt_xy1@legend_mean = False

;--------
; plot
;--------
  plot_xy1 = ignorant_xy(wks, xx, yy, labels_xy1, res_xy1, opt_xy1)
  opt1 = True
  trim_fig(wks_type, wks_name, opt1)


end
